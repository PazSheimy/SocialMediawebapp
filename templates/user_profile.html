<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>{{ user.username }}'s Profile</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Add this line to use Font Awesome icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">

    <style>
        .profile-img {
    border-radius: 50%;
    width: 100px;
    height: 100px;
    object-fit: cover;
    margin-bottom: 20px;
}


    </style>
</head>

<body>
    <div class="container">
        <a href="{{ url_for('feed') }}" class="btn btn-primary mt-2 mb-2"><i class="fas fa-arrow-left"></i> Back to Feed</a>
        <h1 class="mt-5 mb-5">{{ user.username }}'s Profile</h1>

        <div class="card">
            <div class="card-body">
                <div class="profile-header">
                    <img class="profile-img" src="{{ url_for('static', filename='profile/' + user.profile_pic) }}" alt="Profile Picture">
                    <h3>Joined on {{ user.joined_at.date() }}</h3>
                </div>

                {% if current_user == user %}
                <a href="{{ url_for('edit_profile') }}" class="btn btn-secondary mt-2 mb-2"><i class="fas fa-edit"></i> Edit Profile</a>
                {% endif %}

                <h3 class="mt-2">Posts</h3>
                {% for post in posts %}
                <div class="mb-2">
                    <p>{{ post.body }}</p>
                    <small class="text-muted">Posted on {{ post.timestamp.date() }}</small>
                </div>
                {% endfor %}

                <h3 class="mt-2">Media</h3>
                {% for medium in media %}
                <div class="mb-2">
                    <p>{{ medium.filename }}</p>
                    <small class="text-muted">Uploaded on {{ medium.upload_time.date() }}</small>
                    <!-- Display media files -->
                    {% if medium.media_type == 'image' %}
                    <img class="img-fluid" src="{{ url_for('static', filename='img/' + medium.filename) }}" alt="User image">
                    {% elif medium.media_type == 'video' %}
                    <video controls>
                        <source src="{{ url_for('static', filename='videos/' + medium.filename) }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    {% endif %}
                    <p>{{ medium.description }}</p>
                </div>
                {% endfor %}

                <h3 class="mt-2">Followers ({{ follower_counts}})</h3>
                <ul>
                    {% for follower in user.followers %}
                    <li><a href="{{ url_for('user', username=follower.username) }}">{{ follower.username }}</a></li>
                    {% endfor %}
                </ul>

                <h3 class="mt-2">Following ({{ followee_counts}})</h3>
                <ul>
                    {% for followee in user.followed %}
                    <li><a href="{{ url_for('user', username=followee.username) }}">{{ followee.username }}</a></li>
                    {% endfor %}
                </ul>


                {% if current_user.is_following(user) %}
                <form action="{{ url_for('unfollow', user_id=user.id) }}" method="post">
                    <button type="submit" class="btn btn-primary mt-2"><i class="fas fa-user-minus"></i> Unfollow</button>
                </form>
                {% else %}
                <form action="{{ url_for('follow', user_id=user.id) }}" method="post">
                    <button type="submit" class="btn btn-primary mt-2"><i class="fas fa-user-plus"></i> Follow</button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
</body>

</html>
